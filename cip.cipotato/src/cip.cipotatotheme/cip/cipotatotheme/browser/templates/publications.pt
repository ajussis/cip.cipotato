<html metal:use-macro="here/main_template/macros/master">
<metal:block fill-slot="top_slot"
                 tal:define="disable_column_one python:request.set('disable_plone.leftcolumn',1);
                             disable_column_two python:request.set('disable_plone.rightcolumn',2);" />
    <metal:main_macro define-macro="main">
        <metal:main fill-slot="main"
                    tal:define="clatestpublications python: getattr(context, 'clatestpublications');
                                c_newsletters python: getattr(context, 'c_newsletters');
                                c_fact_sheets_leaflets python: getattr(context, 'c-fact-sheets-leaflets');
                                c_brochure python: getattr(context, 'c-brochure');
                                c_press_articles python:getattr(context, 'c-press-articles');
                                c_posters python:getattr(context, 'c-posters');
                                c_bulletins python:getattr(context, 'c-bulletins');
                                c_working_papers python: getattr(context, 'c-working-papers');
                                c_conference_abstracts_proceedings python: getattr(context, 'c-conference-abstracts-proceedings');
                                c_books python: getattr(context, 'c-books');
                                c_annual_reports python: getattr(context, 'c-annual-reports');
                                c-plans-financial-reports python: getattr(context, 'c-plans-financial-reports');
                                c-studies-reports python: getattr(context, 'c-studies-reports');
                                allpubcats python:[c_newsletters, c_fact_sheets_leaflets,c_brochure,c_press_articles,c_posters,c_bulletins,c_working_papers,c_conference_abstracts_proceedings];
                                allpubcats_add python:['newsletter', 'fact-sheets-leaflets','brochure','press-articles','posters','bulletins','working-papers','conference-abstracts-proceedings',''];
                                toLocalizedTime nocall:context/@@plone/toLocalizedTime;">

            <h1>Publications</h1>

            <div class="pub_menu">
                <div class="pub_menu_item">
                    General
                </div>
                <div class="pub_menu_item">
                    Research
                </div>
                <div class="pub_menu_item">
                    Training
                </div>
                <div class="pub_menu_item">
                    Organization
                </div>
            </div>

            <div class="pub_links">
                <ul>
                    <li id="pubcat" class="pubcat_1">
                        <a href="">Newsletters</a>
                    </li>
                    <li id="pubcat" class="pubcat_2">
                        <a href="">Factsheets and leaflets</a>
                    </li>
                    <li id="pubcat" class="pubcat_3">
                        <a href="">Press articles</a>
                    </li>
                    <li id="pubcat" class="pubcat_3">
                        <a href="">Brochures</a>
                    </li>
                    <li id="pubcat" class="pubcat_4">
                        <a href="">Posters</a>
                    </li>
                    <li id="pubcat" class="pubcat_6">
                        <a href="">Bulletins</a>
                    </li>
                </ul>
            </div>
            <div class="pub_links">
                <ul>
                    <li id="pubcat" class="pubcat_7">
                        <a href="">Working papers</a>
                    </li>
                    <li id="pubcat" class="pubcat_8">
                        <a href="">Conference papers</a>
                    </li>
                    <li id="pubcat" class="pubcat_8">
                        <a href="">Studies & reports</a>
                    </li>
                    <li>
                        <a href="">Books</a>
                    </li>
                </ul>
            </div>
            <div class="pub_links">
                <ul>
                    <li>
                        <a href="">-----------------</a>
                    </li>
                    <li>
                        <a href="">-----------------</a>
                    </li>
                    <li>
                        <a href="">-----------------</a>
                    </li>
                    <li>
                        <a href="">-----------------</a>
                    </li>
                </ul>
            </div>
            <div class="pub_links">
                <ul>
                    <li>
                        <a href="">Annual reports</a>
                    </li>
                    <li>
                        <a href="">Plans and financial reports</a>
                    </li>
                </ul>
            </div>

            <div class="lineBreak"></div>

            <!-- Latest of all publications -->

            <div id="panes">
                <div class="pubs_pubcat_latest" tal:define="n clatestpublications/queryCatalog;">
                    <div class="pub_listing" tal:repeat="m n">
                        <tal:rep define="author m/Creator">
                            <!--div class="pub_img" tal:content="m/getURL" /-->
                            <b>
                                <a href="#" tal:attributes="href m/getURL">
                                    <span tal:replace="m/pretty_title_or_id"/>
                                </a>
                            </b>
                            <span class="pub_date">
                                <span tal:content="python:toLocalizedTime(m.Date)" />
                            </span>
                            <p tal:content="m/Description" />
                        </tal:rep>
                    </div>
                </div>
                <tal:defs3 repeat="pub allpubcats_add">
                    <tal:defs4 tal:define="pubs python:view.Pubs(pub)">
                        <div tal:define="pubnum repeat/pub/number;
                                         classname python:'pubs_pubcat_'+str(pubnum)"
                             tal:attributes="class classname">
                            <hr class="basicLine" />
                            <div class="pubs_title">
                                <h2 class="pub_titles">Latest <!--span tal:replace="pub" /--></h2>
                                <h2 class="pub_titles2" tal:define="u pub"><a tal:attributes="href u">See all</a></h2>
                            </div>
                            <div class="lineBreak"></div>
                            <div class="pub_listing" tal:repeat="m pubs">
                                <tal:rep define="tit m/pretty_title_or_id">
                                    <tal:defs define="pc m/getPubcode">
                                        <div tal:condition="python:view.ImageExist(pc)">
                                            <img src="" alt=""
                                                 tal:attributes="src python:'images/' + pc + '-jpg/image_thumb';
                                                                 class python:'pub-img';" />
                                        </div>
                                    </tal:defs>
                                    <span class="pub_date">
                                        <span tal:content="python:toLocalizedTime(m.Date)" /><br />
                                    </span>
                                    <b>
                                        <a href="#" tal:attributes="href m/getURL">
                                            <span tal:replace="tit"/>
                                        </a>
                                    </b>
                                </tal:rep>
                                <div class="lineBreak"></div>
                            </div>
                        </div>
                    </tal:defs4>
                </tal:defs3>



                <!--tal:defs2 define="pubs allpubcats">
                    <tal:defs3 repeat="pub pubs">
                        <tal:defs4 tal:define="n pub/queryCatalog;">
                            <div tal:define="pubnum repeat/pub/number;
                                             classname python:'pubs_pubcat_'+str(pubnum)"
                                 tal:attributes="class classname">
                                <div class="pubs_title">
                                    <h2 class="pub_titles">Latest <span tal:replace="pub/title" /></h2>
                                    <h2 class="pub_titles" tal:define="u python:allpubcats_add[pubnum-1]"><a tal:attributes="href u">See all</a></h2>
                                </div>
                                <div class="lineBreak"></div>
                                <div class="pub_listing" tal:repeat="m n">
                                    <tal:rep define="tit m/pretty_title_or_id">
                                        <div tal:define="item_url m/getURL;">
                                            <img src="" alt=""
                                                 tal:attributes="src python:item_url + '/image_thumb';
                                                                 class python:'pub-img';" />
                                        </div>
                                        <b>
                                            <a href="#" tal:attributes="href m/getURL">
                                                <span tal:replace="m/pretty_title_or_id"/>
                                            </a>
                                        </b>
                                        <span class="pub_date">
                                            <span tal:content="python:toLocalizedTime(m.Date)" />
                                        </span>
                                        <p tal:content="m/Description" />
                                    </tal:rep>
                                </div>
                            </div>
                        </tal:defs4>
                    </tal:defs3>
                </tal:defs2-->
            </div>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
        <script>
            $(document).ready(function() {
                $('.pubs_pubcat_latest').show();
                $('[class^=pubs_pubcat_]').hide();
                $('[id^=pubcat]').click(function() {
                    $('[class^=pubs_pubcat_]').hide();
                    var $this = $(this);
                    var x = $this.attr("className");
                    $('.pubs_' + x).toggle('slow');
                    return false;
                });
            });
        </script>

        </metal:main>
    </metal:main_macro>
</html>
